<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Search Assortment — automotive / car_covers</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Fonts: Proxima Nova if installed, else Inter -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

  <!-- Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- DataTables + Buttons -->
  <link rel="stylesheet" href="https://cdn.datatables.net/v/bs5/dt-2.0.3/b-3.0.1/fh-4.0.1/r-3.0.1/datatables.min.css"/>

  <style>
    :root {
      --bg: #0f1220;
      --card: #141a2a;
      --card-2: #181e31;
      --text: #f3f6ff;
      --text-dim: #b8c1d9;
      --border: #252c42;
      --brand: #7aa2ff;
      --brand-soft: #1a2340;
      --card-radius: 14px;
    }
    * { font-family: "Proxima Nova", Inter, "Segoe UI", Roboto, system-ui, -apple-system, Arial, sans-serif; }
    html, body { background: var(--bg); color: var(--text); }

    .page-header {
      background: radial-gradient(1200px 400px at 10% -10%, rgba(122,162,255,.25), transparent),
                  linear-gradient(90deg, var(--brand-soft), rgba(10,14,25,0.6));
      border-bottom: 1px solid var(--border);
    }
    .page-header h2 { font-weight: 700; letter-spacing:.2px; color: var(--text); }
    .muted { color: var(--text-dim); }

    .btn, .btn:focus, .btn:active { box-shadow:none; }
    .btn-outline-secondary { color: var(--text); border-color: var(--border); }
    .btn-outline-secondary:hover { background: var(--card-2); border-color: var(--border); }
    .btn-outline-primary { color: var(--text); border-color: var(--brand); }
    .btn-outline-primary:hover { background: rgba(122,162,255,.12); }

    .section-card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: var(--card-radius);
      box-shadow: 0 8px 24px rgba(0,0,0,.25);
      padding: 1rem 1.1rem 1.25rem 1.1rem;
      height: 100%;
      contain: content;
      color: var(--text);
    }
    .section-title { font-weight: 700; font-size: 1.05rem; margin-bottom:.6rem; color: var(--text); }

    /* Executive summary pills */
    .summary-pill {
      border-radius: 999px;
      padding:.7rem 1.1rem;
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
      border:1px solid var(--border);
      display:inline-flex; gap:.6rem; align-items:center;
      box-shadow: 0 6px 16px rgba(0,0,0,.25);
      margin:.3rem .6rem .3rem 0;
    }
    .summary-pill .label { color: var(--text-dim); font-size:.9rem; }
    .summary-pill .value { font-weight:700; color: var(--text); font-size:1.05rem; }

    /* DataTables dark theme */
    table.dataTable { table-layout: fixed; color: var(--text); }
    table.table {
      --bs-table-color: var(--text);
      --bs-table-bg: transparent;
      --bs-table-striped-color: var(--text);
      --bs-table-hover-color: var(--text);
      --bs-table-border-color: var(--border);
      --bs-table-striped-bg: rgba(255,255,255,0.06);
      --bs-table-hover-bg: rgba(255,255,255,0.08);
    }
    /* Center headers horizontally + vertically */
    table.dataTable thead th {
      background: var(--card-2) !important;
      border-bottom: 1px solid var(--border) !important;
      color: var(--text) !important;
      text-align: center !important;
      vertical-align: middle !important;
    }
    /* Center body cells horizontally + vertically by default */
    table.dataTable tbody td {
      border-color: var(--border);
      color: var(--text);
      text-align: center;
      vertical-align: middle;
    }
    /* Override DataTables' numeric right-align helpers */
    table.dataTable td.dt-type-numeric,
    table.dataTable th.dt-type-numeric,
    table.dataTable td.dt-right,
    table.dataTable th.dt-right,
    table.dataTable td.dt-body-right,
    table.dataTable th.dt-head-right {
      text-align: center !important;
    }

    /* Inputs */
    .dataTables_wrapper .dataTables_info,
    .dataTables_wrapper .dataTables_length label,
    .dataTables_wrapper .dataTables_filter label { color: var(--text-dim); }
    .dataTables_wrapper .dataTables_filter input,
    .dataTables_wrapper .dataTables_length select {
      background: var(--card-2);
      color: var(--text);
      border: 1px solid var(--border);
      border-radius: 10px;
    }
    .dataTables_wrapper .dataTables_filter input::placeholder { color: var(--text-dim); }

    /* Pagination */
    .dataTables_wrapper .dataTables_paginate .paginate_button {
      color: var(--text) !important; border-color: var(--border) !important;
      background: transparent !important;
    }
    .dataTables_wrapper .dataTables_paginate .paginate_button.current {
      background: var(--brand-soft) !important; border-color: var(--border) !important; color: var(--text) !important;
    }

    a, a:visited { color: var(--brand); }
    a:hover { color: #aecdff; }

    /* Long text handling */
    .wrap-text { white-space: pre-wrap; line-height:1.35rem; color: var(--text); }

    /* Actionables block */
    .act {
      display: grid;
      grid-template-columns: 130px 1fr;
      align-items: center;
      column-gap: .8rem;
      background: var(--card-2); border: 1px solid var(--border);
      border-radius: 12px; padding:.65rem .8rem; color: var(--text);
      text-align: left;
    }
    .act .tag {
      justify-self: center;
      font-size:.72rem; font-weight:700; text-transform:uppercase;
      letter-spacing:.04em; color: var(--brand);
      padding:.22rem .55rem; border:1px solid var(--brand); border-radius:999px;
      background: rgba(122,162,255,.08);
    }
    .act .txt { color: var(--text); }

    /* Left-align ONLY the Actionables column */
    td.col-actionables, th.col-actionables {
      text-align: left !important;
      vertical-align: top !important;
    }

    /* PLP combined cell: stack links vertically */
    .plp-links a { display:block; line-height:1.2; margin-bottom:.25rem; }

    .footer-note { color: var(--text-dim); font-size:.85rem; }
  </style>
</head>

<body>
  <header class="page-header py-3">
    <div class="container">
      <div class="d-flex flex-wrap align-items-center justify-content-between">
        <div>
          <h2 class="mb-0">Search Assortment — automotive / car_covers</h2>
          <div class="muted">Category: <strong>automotive</strong> &nbsp;|&nbsp; Subtype: <strong>car_covers</strong></div>
        </div>
        <div class="text-end">
          <a class="btn btn-outline-secondary btn-sm" href="#" onclick="window.print()">Print</a>
        </div>
      </div>
    </div>
  </header>

  <main class="container my-4">

    <!-- Executive Summary -->
    <div class="section-card mb-4">
      <div class="d-flex align-items-center flex-wrap">
        <div class="summary-pill"><span class="label">Category GMV (L30D)</span><span class="value" id="pill-score">—</span></div>
        <div class="summary-pill"><span class="label">Overall Est. Search Hits (L30D)</span><span class="value" id="pill-hits">—</span></div>
        <div class="summary-pill"><span class="label">Overall Est. GMV Opportunity (L30D) </span><span class="value" id="pill-gmv">—</span></div>
        <div class="muted text-start" style="font-size:0.72em;">Results compare the top 15 products from noon and Amazon. Some brands marked as missing may appear lower 
        on noon but are present in Amazon's top 15. Est. potential GMV is estimated based on ideal search hits share on the keywords (given an ideal assortment), 
        category average conversion and Amazon's average offer price</div>
      </div>
    </div>

    <!-- Keyword level insights -->
    <div class="row g-4">
      <div class="col-lg-6">
        <div class="section-card">
          <div class="section-title">Keyword Insights — Generic</div>
          <table id="tbl-generic" class="table table-striped table-hover w-100"></table>
        </div>
      </div>
      <div class="col-lg-6">
        <div class="section-card">
          <div class="section-title">Keyword Insights — Branded</div>
          <table id="tbl-branded" class="table table-striped table-hover w-100"></table>
        </div>
      </div>
    </div>

    <!-- Detailed analysis -->
    <div class="section-card mt-4">
      <div class="d-flex justify-content-between align-items-center">
        <div class="section-title mb-0">Detailed Analysis</div>
        
      </div>
      <p class="muted mb-2">Actionables per search term. Links open in a new tab.</p>
      <table id="tbl-detail" class="table table-striped table-hover w-100"></table>
    </div>

    <div class="my-4 footer-note">
      Data source: <code>noonbigmerchsandbox.satyam.search_assortment_eval_final_draft3</code>. Report for <strong>automotive × car_covers</strong>. Generated on : <strong>19 Sep 2025, 06:25 PM</strong>
    </div>
  </main>

  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.datatables.net/v/bs5/dt-2.0.3/b-3.0.1/fh-4.0.1/r-3.0.1/datatables.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>

  <script>
    const EXEC_SUMMARY = {"overall_score": 42088.0, "overall_st_hits": 1726, "overall_gmv_oppt": 4076.0};
    const DATA_GENERIC = [{"search_term": "custom fit car covers", "performance": "Average (0.89)", "st_hits": 103, "gmv_oppt": 495.0, "outcome": 2}, {"search_term": "outdoor car covers", "performance": "Average (0.88)", "st_hits": 206, "gmv_oppt": 518.0, "outcome": 1}, {"search_term": "waterproof car covers", "performance": "Good (0.94)", "st_hits": 258, "gmv_oppt": 381.0, "outcome": 4}, {"search_term": "breathable car covers", "performance": "Excellent (0.96)", "st_hits": 155, "gmv_oppt": 369.0, "outcome": 3}, {"search_term": "car cover", "performance": "Excellent (0.96)", "st_hits": 774, "gmv_oppt": 1742.0, "outcome": 5}];
    const DATA_BRANDED = [{"search_term": "factoryoutlet car cover", "performance": "Average (0.88)", "st_hits": 15, "gmv_oppt": 47.0, "outcome": 1}, {"search_term": "allextreme car cover", "performance": "Poor (0.65)", "st_hits": 77, "gmv_oppt": 146.0, "outcome": 2}, {"search_term": "roadpower car cover", "performance": "Below Average (0.78)", "st_hits": 41, "gmv_oppt": 121.0, "outcome": 4}, {"search_term": "caronic car cover", "performance": "Below Average (0.71)", "st_hits": 62, "gmv_oppt": 180.0, "outcome": 3}];
    const DATA_DETAIL  = [{"search_term": "factoryoutlet car cover", "brand_actionable": "Brand 'factoryoutlet' is absent on noon but present on Amazon with 1 relevant SKU; noon shows no products from this brand.", "assortment_actionable": "Noon lacks any 'factoryoutlet' car cover variants; Amazon offers 1 relevant SKU matching keyword and category.", "overall_perception": null, "noon_plp_link": "https://www.noon.com/uae-en/search/?q=factoryoutlet%20car%20cover&av=0&e[search-ae]=google", "amazon_plp_link": "https://www.amazon.ae/s?k=factoryoutlet+car+cover", "outcome": 1, "performance_tag": "Average", "st_hits": 15, "gmv_oppt": 47.0}, {"search_term": "allextreme car cover", "brand_actionable": "Brand Allextreme is present on Amazon with 1 relevant SKU; absent on noon with zero relevant products matching keyword and category+subcategory.", "assortment_actionable": "Noon lacks Allextreme car covers entirely; Amazon offers 1 relevant Allextreme car cover SKU, indicating a clear assortment gap for this brand.", "overall_perception": null, "noon_plp_link": "https://www.noon.com/uae-en/search/?q=allextreme%20car%20cover&av=0&e[search-ae]=google", "amazon_plp_link": "https://www.amazon.ae/s?k=allextreme+car+cover", "outcome": 2, "performance_tag": "Poor", "st_hits": 77, "gmv_oppt": 146.0}, {"search_term": "roadpower car cover", "brand_actionable": "RoadPower is present on both noon and Amazon with strong SKU presence and relevant car cover products matching keyword and category.", "assortment_actionable": "Noon offers similar RoadPower car cover variants as Amazon, covering multiple sizes and models; assortment quality and relevance are aligned.", "overall_perception": null, "noon_plp_link": "https://www.noon.com/uae-en/search/?q=roadpower%20car%20cover&av=0&e[search-ae]=google", "amazon_plp_link": "https://www.amazon.ae/s?k=roadpower+car+cover", "outcome": 4, "performance_tag": "Below Average", "st_hits": 41, "gmv_oppt": 121.0}, {"search_term": "caronic car cover", "brand_actionable": "Brand CARONIC is present on both noon and Amazon with similar SKU counts; all products are relevant to car covers category and subcategory.", "assortment_actionable": "Noon and Amazon have comparable CARONIC car cover variants; noon also lists some irrelevant sun visor items under the brand.", "overall_perception": null, "noon_plp_link": "https://www.noon.com/uae-en/search/?q=caronic%20car%20cover&av=0&e[search-ae]=google", "amazon_plp_link": "https://www.amazon.ae/s?k=caronic+car+cover", "outcome": 3, "performance_tag": "Below Average", "st_hits": 62, "gmv_oppt": 180.0}, {"search_term": "custom fit car covers", "brand_actionable": "Brands missing on noon: GORDITA, Proadsy, kayme, aoulette, FiveFox, Allextreme, sportuli. Common brands: None.", "assortment_actionable": "Noon shows fewer SKUs and limited brand diversity; assortment dominated by few brands and repeated ELTRAZONE models; Amazon offers broader custom fit variants.", "overall_perception": null, "noon_plp_link": "https://www.noon.com/uae-en/search/?q=custom%20fit%20car%20covers&av=0&e[search-ae]=google", "amazon_plp_link": "https://www.amazon.ae/s?k=custom+fit+car+covers", "outcome": 2, "performance_tag": "Average", "st_hits": 103, "gmv_oppt": 495.0}, {"search_term": "outdoor car covers", "brand_actionable": "Brands missing on noon: kayme, GORDITA, DAYONG, ROADPOWER, Favoto, SYOSI, X AUTOHAUX. Common brands: none.", "assortment_actionable": "Noon shows fewer brands and less variety; assortment dominated by few brands and generic items; Amazon offers more diverse and specialized car covers.", "overall_perception": null, "noon_plp_link": "https://www.noon.com/uae-en/search/?q=outdoor%20car%20covers&av=0&e[search-ae]=google", "amazon_plp_link": "https://www.amazon.ae/s?k=outdoor+car+covers", "outcome": 1, "performance_tag": "Average", "st_hits": 206, "gmv_oppt": 518.0}, {"search_term": "waterproof car covers", "brand_actionable": "Brands missing on noon: kayme, GORDITA, DURAGS, SYOSI. Common brands: None. Noon brands are mostly unique or generic, Amazon brands mostly unbranded or different.", "assortment_actionable": "Noon shows more branded SKUs but limited brand diversity; Amazon has more unbranded and disposable covers. Noon lacks some variant styles like disposable covers.", "overall_perception": null, "noon_plp_link": "https://www.noon.com/uae-en/search/?q=waterproof%20car%20covers&av=0&e[search-ae]=google", "amazon_plp_link": "https://www.amazon.ae/s?k=waterproof+car+covers", "outcome": 4, "performance_tag": "Good", "st_hits": 258, "gmv_oppt": 381.0}, {"search_term": "breathable car covers", "brand_actionable": "Brands missing on noon: kayme, GORDITA, Beauenty, Beaunety, DAYONG, Favoto, WinPower, Factory Outlet, CARONIC. Common brands: fenex.", "assortment_actionable": "Noon shows fewer SKUs and less brand diversity; assortment dominated by few brands and some irrelevant seat covers included.", "overall_perception": null, "noon_plp_link": "https://www.noon.com/uae-en/search/?q=breathable%20car%20covers&av=0&e[search-ae]=google", "amazon_plp_link": "https://www.amazon.ae/s?k=breathable+car+covers", "outcome": 3, "performance_tag": "Excellent", "st_hits": 155, "gmv_oppt": 369.0}, {"search_term": "car cover", "brand_actionable": "Brands missing on noon: kayme, Beauenty, CARONIC, DURAGS. Common brands: ROADPOWER, GROIC, COOLBABY.", "assortment_actionable": "Noon has fewer brand variants and more generic products; Amazon shows broader brand diversity and more SKU variety in car covers.", "overall_perception": null, "noon_plp_link": "https://www.noon.com/uae-en/search/?q=car%20cover&av=0&e[search-ae]=google", "amazon_plp_link": "https://www.amazon.ae/s?k=car+cover", "outcome": 5, "performance_tag": "Excellent", "st_hits": 774, "gmv_oppt": 1742.0}];

    const clean_text = (text) => term.replace(/ /g, '_')

    const linkToDetail = (term) => `<a class="kw-link" href=#${term.replace(/ /g, '_')}>${term}</a>`;

    const toNumber = (v) => {
      if (v === null || v === undefined) return NaN;
      if (typeof v === 'number') return v;
      if (typeof v === 'string') {
        const s = v.replace(/,/g, '').trim();
        return s === '' ? NaN : Number(s);
      }
      return NaN;
    };
    const fmtInt = (v) => Number.isFinite(toNumber(v)) ? toNumber(v).toLocaleString() : "—";
    const fmtNum = (v) =>
      Number.isFinite(toNumber(v))
        ? toNumber(v).toLocaleString(undefined, { minimumFractionDigits:0, maximumFractionDigits:2 })
        : "—";

    const toLink = (url, label) => {
      if (!url || typeof url !== 'string') return '';
      const safe = url.startsWith('http') ? url : null;
      return safe ? `<a href="${safe}" target="_blank" rel="noopener">${label || 'Open'}</a>` : '';
    };
    const escapeHTML = (s) =>
      String(s ?? '').replace(/[&<>"']/g, (m) => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'})[m]);

    // Build single "Actionables" cell (no Show more / no clamping)
    const makeActionablesCell = (row) => {
      const items = [];
      if (row.assortment_actionable) items.push(`<div class="act"><div class="tag">Assortment</div><div class="txt wrap-text">${escapeHTML(row.assortment_actionable)}</div></div>`);
      if (row.brand_actionable) items.push(`<div class="act"><div class="tag">Brand</div><div class="txt wrap-text">${escapeHTML(row.brand_actionable)}</div></div>`);
      const content = items.join('');
      return `<div class="cell-stack"><div class="wrap-text">${content}</div></div>`;
    };

    // Helper: pick GMV opportunity from available keys (gmv_oppt preferred)
    const pickGmvOppt = (row) => {
      const v = row.gmv_oppt ?? row.gmv_loss ?? row.gmv_opportunity ?? null;
      return v;
    };

    document.addEventListener('DOMContentLoaded', () => {
      document.getElementById('pill-score').textContent = fmtInt(EXEC_SUMMARY.overall_score ?? 0);
      document.getElementById('pill-hits').textContent  = fmtInt(EXEC_SUMMARY.overall_st_hits);
      document.getElementById('pill-gmv').textContent   = fmtNum(EXEC_SUMMARY.overall_gmv_oppt);

      // Generic table (center columns)
      $('#tbl-generic').DataTable({
        data: DATA_GENERIC,
        columns: [
          { title:'Search Term',     data:'search_term', className:'text-center align-middle', render:(d)=>linkToDetail(d)},
          { title:'Priority',         data:'outcome',      className:'text-center align-middle', render:(d)=>escapeHTML(d ?? '—') },
          { title:'Est. Hits',     data:'st_hits',     className:'text-center align-middle', render:(d)=>fmtInt(d) },
          { title:'Est. GMV Potential', data:'gmv_oppt',      className:'text-center align-middle', render:(d)=>fmtNum(d) }
        ],
        order: [[1,'asc']], responsive: true, fixedHeader: false, deferRender: true, autoWidth: false,
        pageLength: 10, lengthMenu: [10,25,50,100], dom:'Bfrtip', buttons:['pageLength','copy','csv']
      });

      // Branded table (center columns)
      $('#tbl-branded').DataTable({
        data: DATA_BRANDED,
        columns: [
          { title:'Search Term',     data:'search_term', className:'text-center align-middle', render:(d)=>linkToDetail(d) },
          { title:'Priority',         data:'outcome',      className:'text-center align-middle', render:(d)=>escapeHTML(d ?? '—') },
          { title:'Est. Hits',     data:'st_hits',     className:'text-center align-middle', render:(d)=>fmtInt(d) },
          { title:'Est. GMV Potential', data:'gmv_oppt',      className:'text-center align-middle', render:(d)=>fmtNum(d) }
        ],
        order: [[1,'asc']], responsive: true, fixedHeader: false, deferRender: true, autoWidth: false,
        pageLength: 10, lengthMenu: [10,25,50,100], dom:'Bfrtip', buttons:['pageLength','copy','csv']
      });

      // Detailed Analysis (center everything except Actionables)
      const dtDetail = $('#tbl-detail').DataTable({
        data: DATA_DETAIL,
        columns: [
          { title:'Search Term',     data:'search_term',   width:'10%', className:'text-center align-middle' },
          { title:'Insights',     data:null,            width:'54%', className:'col-actionables', render:(d,t,row)=>makeActionablesCell(row) },
          { title:'Est. Hits',     data:'st_hits',       width:'8%', className:'text-center align-middle', render:(d)=>fmtInt(d) },
          { title:'Est. GMV Potential', data:null,            width:'10%', className:'text-center align-middle', render:(d,t,row)=>fmtNum(pickGmvOppt(row)) },
          { title:'PLP',             data:null,            width:'10%', className:'text-center align-middle',
          render:(d,t,row)=>{const parts = [];
            if (row.noon_plp_link)   parts.push(toLink(row.noon_plp_link,   'noon search results'));
            if (row.amazon_plp_link) parts.push(toLink(row.amazon_plp_link, 'Amazon search results'));
            return parts.length ? '<div class="plp-links">' + parts.join('') + '</div>' : '—';
          }
          }
        ],
        order: [[3,'desc']], responsive: false, fixedHeader: false, deferRender: true, autoWidth: false,
        pageLength: 15, lengthMenu: [15,25,50,100], dom:'Bfrtip', buttons:['pageLength','copy','csv'],
        rowId: (d) => d.search_term.replace(/ /g, '_')
      });

      
    });
  </script>
</body>
</html>
