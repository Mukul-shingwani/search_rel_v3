<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Search Assortment — automotive / air_freshener</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Fonts: Proxima Nova if installed, else Inter -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

  <!-- Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- DataTables + Buttons -->
  <link rel="stylesheet" href="https://cdn.datatables.net/v/bs5/dt-2.0.3/b-3.0.1/fh-4.0.1/r-3.0.1/datatables.min.css"/>

  <style>
    :root {
      --bg: #0f1220;
      --card: #141a2a;
      --card-2: #181e31;
      --text: #f3f6ff;
      --text-dim: #b8c1d9;
      --border: #252c42;
      --brand: #7aa2ff;
      --brand-soft: #1a2340;
      --card-radius: 14px;
    }
    * { font-family: "Proxima Nova", Inter, "Segoe UI", Roboto, system-ui, -apple-system, Arial, sans-serif; }
    html, body { background: var(--bg); color: var(--text); }

    .page-header {
      background: radial-gradient(1200px 400px at 10% -10%, rgba(122,162,255,.25), transparent),
                  linear-gradient(90deg, var(--brand-soft), rgba(10,14,25,0.6));
      border-bottom: 1px solid var(--border);
    }
    .page-header h2 { font-weight: 700; letter-spacing:.2px; color: var(--text); }
    .muted { color: var(--text-dim); }

    .btn, .btn:focus, .btn:active { box-shadow:none; }
    .btn-outline-secondary { color: var(--text); border-color: var(--border); }
    .btn-outline-secondary:hover { background: var(--card-2); border-color: var(--border); }
    .btn-outline-primary { color: var(--text); border-color: var(--brand); }
    .btn-outline-primary:hover { background: rgba(122,162,255,.12); }

    .section-card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: var(--card-radius);
      box-shadow: 0 8px 24px rgba(0,0,0,.25);
      padding: 1rem 1.1rem 1.25rem 1.1rem;
      height: 100%;
      contain: content;
      color: var(--text);
    }
    .section-title { font-weight: 700; font-size: 1.05rem; margin-bottom:.6rem; color: var(--text); }

    /* Executive summary pills */
    .summary-pill {
      border-radius: 999px;
      padding:.7rem 1.1rem;
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
      border:1px solid var(--border);
      display:inline-flex; gap:.6rem; align-items:center;
      box-shadow: 0 6px 16px rgba(0,0,0,.25);
      margin:.3rem .6rem .3rem 0;
    }
    .summary-pill .label { color: var(--text-dim); font-size:.9rem; }
    .summary-pill .value { font-weight:700; color: var(--text); font-size:1.05rem; }

    /* DataTables dark theme */
    table.dataTable { table-layout: fixed; color: var(--text); }
    table.table {
      --bs-table-color: var(--text);
      --bs-table-bg: transparent;
      --bs-table-striped-color: var(--text);
      --bs-table-hover-color: var(--text);
      --bs-table-border-color: var(--border);
      --bs-table-striped-bg: rgba(255,255,255,0.06);
      --bs-table-hover-bg: rgba(255,255,255,0.08);
    }
    /* Center headers horizontally + vertically */
    table.dataTable thead th {
      background: var(--card-2) !important;
      border-bottom: 1px solid var(--border) !important;
      color: var(--text) !important;
      text-align: center !important;
      vertical-align: middle !important;
    }
    /* Center body cells horizontally + vertically by default */
    table.dataTable tbody td {
      border-color: var(--border);
      color: var(--text);
      text-align: center;
      vertical-align: middle;
    }
    /* Override DataTables' numeric right-align helpers */
    table.dataTable td.dt-type-numeric,
    table.dataTable th.dt-type-numeric,
    table.dataTable td.dt-right,
    table.dataTable th.dt-right,
    table.dataTable td.dt-body-right,
    table.dataTable th.dt-head-right {
      text-align: center !important;
    }

    /* Inputs */
    .dataTables_wrapper .dataTables_info,
    .dataTables_wrapper .dataTables_length label,
    .dataTables_wrapper .dataTables_filter label { color: var(--text-dim); }
    .dataTables_wrapper .dataTables_filter input,
    .dataTables_wrapper .dataTables_length select {
      background: var(--card-2);
      color: var(--text);
      border: 1px solid var(--border);
      border-radius: 10px;
    }
    .dataTables_wrapper .dataTables_filter input::placeholder { color: var(--text-dim); }

    /* Pagination */
    .dataTables_wrapper .dataTables_paginate .paginate_button {
      color: var(--text) !important; border-color: var(--border) !important;
      background: transparent !important;
    }
    .dataTables_wrapper .dataTables_paginate .paginate_button.current {
      background: var(--brand-soft) !important; border-color: var(--border) !important; color: var(--text) !important;
    }

    a, a:visited { color: var(--brand); }
    a:hover { color: #aecdff; }

    /* Long text handling */
    .wrap-text { white-space: pre-wrap; line-height:1.35rem; color: var(--text); }

    /* Actionables block */
    .act {
      display: grid;
      grid-template-columns: 130px 1fr;
      align-items: center;
      column-gap: .8rem;
      background: var(--card-2); border: 1px solid var(--border);
      border-radius: 12px; padding:.65rem .8rem; color: var(--text);
      text-align: left;
    }
    .act .tag {
      justify-self: center;
      font-size:.72rem; font-weight:700; text-transform:uppercase;
      letter-spacing:.04em; color: var(--brand);
      padding:.22rem .55rem; border:1px solid var(--brand); border-radius:999px;
      background: rgba(122,162,255,.08);
    }
    .act .txt { color: var(--text); }

    /* Left-align ONLY the Actionables column */
    td.col-actionables, th.col-actionables {
      text-align: left !important;
      vertical-align: top !important;
    }

    /* PLP combined cell: stack links vertically */
    .plp-links a { display:block; line-height:1.2; margin-bottom:.25rem; }

    .footer-note { color: var(--text-dim); font-size:.85rem; }
  </style>
</head>

<body>
  <header class="page-header py-3">
    <div class="container">
      <div class="d-flex flex-wrap align-items-center justify-content-between">
        <div>
          <h2 class="mb-0">Search Assortment — automotive / air_freshener</h2>
          <div class="muted">Category: <strong>automotive</strong> &nbsp;|&nbsp; Subtype: <strong>air_freshener</strong></div>
        </div>
        <div class="text-end">
          <a class="btn btn-outline-secondary btn-sm" href="#" onclick="window.print()">Print</a>
        </div>
      </div>
    </div>
  </header>

  <main class="container my-4">

    <!-- Executive Summary -->
    <div class="section-card mb-4">
      <div class="d-flex align-items-center flex-wrap">
        <div class="summary-pill"><span class="label">Category GMV (L30D)</span><span class="value" id="pill-score">—</span></div>
        <div class="summary-pill"><span class="label">Overall Est. Search Hits (L30D)</span><span class="value" id="pill-hits">—</span></div>
        <div class="summary-pill"><span class="label">Overall Est. GMV Opportunity (L30D) </span><span class="value" id="pill-gmv">—</span></div>
        <div class="muted text-start" style="font-size:0.72em;">Results compare the top 15 products from noon and Amazon. Some brands marked as missing may appear lower 
        on noon but are present in Amazon's top 15. Est. potential GMV is estimated based on ideal search hits share on the keywords (given an ideal assortment), 
        category average conversion and Amazon's average offer price</div>
      </div>
    </div>

    <!-- Keyword level insights -->
    <div class="row g-4">
      <div class="col-lg-6">
        <div class="section-card">
          <div class="section-title">Keyword Insights — Generic</div>
          <table id="tbl-generic" class="table table-striped table-hover w-100"></table>
        </div>
      </div>
      <div class="col-lg-6">
        <div class="section-card">
          <div class="section-title">Keyword Insights — Branded</div>
          <table id="tbl-branded" class="table table-striped table-hover w-100"></table>
        </div>
      </div>
    </div>

    <!-- Detailed analysis -->
    <div class="section-card mt-4">
      <div class="d-flex justify-content-between align-items-center">
        <div class="section-title mb-0">Detailed Analysis</div>
        
      </div>
      <p class="muted mb-2">Actionables per search term. Links open in a new tab.</p>
      <table id="tbl-detail" class="table table-striped table-hover w-100"></table>
    </div>

    <div class="my-4 footer-note">
      Data source: <code>noonbigmerchsandbox.satyam.search_assortment_eval_final_draft3</code>. Report for <strong>automotive × air_freshener</strong>. Generated on : <strong>19 Sep 2025, 06:25 PM</strong>
    </div>
  </main>

  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.datatables.net/v/bs5/dt-2.0.3/b-3.0.1/fh-4.0.1/r-3.0.1/datatables.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>

  <script>
    const EXEC_SUMMARY = {"overall_score": 69766.0, "overall_st_hits": 18269, "overall_gmv_oppt": 11136.0};
    const DATA_GENERIC = [{"search_term": "long lasting car air freshener", "performance": "Good (0.91)", "st_hits": 589, "gmv_oppt": 324.0, "outcome": 4}, {"search_term": "car fragrance", "performance": "Average (0.89)", "st_hits": 1179, "gmv_oppt": 571.0, "outcome": 5}, {"search_term": "car air freshener", "performance": "Good (0.92)", "st_hits": 4420, "gmv_oppt": 2320.0, "outcome": 1}, {"search_term": "car air freshener spray", "performance": "Good (0.92)", "st_hits": 589, "gmv_oppt": 401.0, "outcome": 3}, {"search_term": "natural car air freshener", "performance": "Average (0.86)", "st_hits": 884, "gmv_oppt": 752.0, "outcome": 2}];
    const DATA_BRANDED = [{"search_term": "bullsone car air freshener", "performance": "Good (0.92)", "st_hits": 1179, "gmv_oppt": 1609.0, "outcome": 3}, {"search_term": "californiacarscents car air freshener", "performance": "Good (0.92)", "st_hits": 1031, "gmv_oppt": 523.0, "outcome": 7}, {"search_term": "sonax car air freshener", "performance": "Poor (0.68)", "st_hits": 442, "gmv_oppt": 229.0, "outcome": 2}, {"search_term": "littletrees car air freshener", "performance": "Poor (0.62)", "st_hits": 884, "gmv_oppt": 313.0, "outcome": 1}, {"search_term": "glade car air freshener", "performance": "Poor (0.68)", "st_hits": 1473, "gmv_oppt": 478.0, "outcome": 9}, {"search_term": "airwick car air freshener", "performance": "Below Average (0.82)", "st_hits": 2210, "gmv_oppt": 1198.0, "outcome": 5}, {"search_term": "areon car air freshener", "performance": "Below Average (0.79)", "st_hits": 1768, "gmv_oppt": 981.0, "outcome": 6}, {"search_term": "meguiars car air freshener", "performance": "Good (0.94)", "st_hits": 737, "gmv_oppt": 1109.0, "outcome": 4}, {"search_term": "godrej car air freshener", "performance": "Below Average (0.78)", "st_hits": 589, "gmv_oppt": 225.0, "outcome": 10}, {"search_term": "kovi car air freshener", "performance": "Average (0.87)", "st_hits": 295, "gmv_oppt": 104.0, "outcome": 8}];
    const DATA_DETAIL  = [{"search_term": "bullsone car air freshener", "brand_actionable": "Brand Bullsone is present on both noon and Amazon with multiple SKUs; all products are relevant to keyword, category, and subcategory.", "assortment_actionable": "Noon offers a good variety of Bullsone air freshener variants similar to Amazon; no significant assortment gaps detected.", "overall_perception": null, "noon_plp_link": "https://www.noon.com/uae-en/search/?q=bullsone%20car%20air%20freshener&av=0&e[search-ae]=google", "amazon_plp_link": "https://www.amazon.ae/s?k=bullsone+car+air+freshener", "outcome": 3, "performance_tag": "Good", "st_hits": 1179, "gmv_oppt": 1609.0}, {"search_term": "californiacarscents car air freshener", "brand_actionable": "California Scents is present on both noon and Amazon with multiple SKUs; noon shows strong relevance and coverage for the brand in automotive air fresheners.", "assortment_actionable": "Noon offers a wide variety of California Scents air fresheners matching Amazon's assortment with multiple scent variants and product types; no significant gaps detected.", "overall_perception": null, "noon_plp_link": "https://www.noon.com/uae-en/search/?q=californiacarscents%20car%20air%20freshener&av=0&e[search-ae]=google", "amazon_plp_link": "https://www.amazon.ae/s?k=californiacarscents+car+air+freshener", "outcome": 7, "performance_tag": "Good", "st_hits": 1031, "gmv_oppt": 523.0}, {"search_term": "sonax car air freshener", "brand_actionable": "SONAX is present on both noon and Amazon with relevant products matching keyword and category.", "assortment_actionable": "Noon offers fewer SONAX air freshener variants compared to Amazon, missing some pack sizes and scent options.", "overall_perception": null, "noon_plp_link": "https://www.noon.com/uae-en/search/?q=sonax%20car%20air%20freshener&av=0&e[search-ae]=google", "amazon_plp_link": "https://www.amazon.ae/s?k=sonax+car+air+freshener", "outcome": 2, "performance_tag": "Poor", "st_hits": 442, "gmv_oppt": 229.0}, {"search_term": "littletrees car air freshener", "brand_actionable": "Brand 'Little Trees' is absent on noon but well represented on Amazon with multiple SKUs; noon shows no relevant Littletrees products in automotive air freshener.", "assortment_actionable": "Noon lacks any Littletrees variants; Amazon offers diverse Littletrees SKU types and scents within car air fresheners.", "overall_perception": null, "noon_plp_link": "https://www.noon.com/uae-en/search/?q=littletrees%20car%20air%20freshener&av=0&e[search-ae]=google", "amazon_plp_link": "https://www.amazon.ae/s?k=littletrees+car+air+freshener", "outcome": 1, "performance_tag": "Poor", "st_hits": 884, "gmv_oppt": 313.0}, {"search_term": "glade car air freshener", "brand_actionable": "Brand Glade is present on both noon and Amazon with strong SKU presence; all products are relevant to keyword, category, and subcategory.", "assortment_actionable": "Noon offers a broad variety of Glade car air fresheners similar to Amazon, covering sprays, gels, holders, and refills; no notable assortment gaps.", "overall_perception": null, "noon_plp_link": "https://www.noon.com/uae-en/search/?q=glade%20car%20air%20freshener&av=0&e[search-ae]=google", "amazon_plp_link": "https://www.amazon.ae/s?k=glade+car+air+freshener", "outcome": 9, "performance_tag": "Poor", "st_hits": 1473, "gmv_oppt": 478.0}, {"search_term": "airwick car air freshener", "brand_actionable": "Air Wick is present on both noon and Amazon with strong relevance and SKU variants; noon shows Air Wick products relevant to air freshener automotive category.", "assortment_actionable": "Noon has slightly fewer Air Wick SKU variants and pack sizes than Amazon but covers key scents and formats well; no major assortment gaps.", "overall_perception": null, "noon_plp_link": "https://www.noon.com/uae-en/search/?q=airwick%20car%20air%20freshener&av=0&e[search-ae]=google", "amazon_plp_link": "https://www.amazon.ae/s?k=airwick+car+air+freshener", "outcome": 5, "performance_tag": "Below Average", "st_hits": 2210, "gmv_oppt": 1198.0}, {"search_term": "areon car air freshener", "brand_actionable": "Areon is present on both noon and Amazon with strong SKU presence and relevant products matching keyword+category+subcategory.", "assortment_actionable": "Noon offers a comparable variety of Areon air freshener variants as Amazon within automotive air fresheners; no significant assortment gaps.", "overall_perception": null, "noon_plp_link": "https://www.noon.com/uae-en/search/?q=areon%20car%20air%20freshener&av=0&e[search-ae]=google", "amazon_plp_link": "https://www.amazon.ae/s?k=areon+car+air+freshener", "outcome": 6, "performance_tag": "Below Average", "st_hits": 1768, "gmv_oppt": 981.0}, {"search_term": "meguiars car air freshener", "brand_actionable": "Meguiar's is well represented on both noon and Amazon with numerous relevant SKUs matching the keyword and category.", "assortment_actionable": "Noon shows a strong variety of Meguiar's air fresheners with multiple scents and pack sizes, comparable or better than Amazon.", "overall_perception": null, "noon_plp_link": "https://www.noon.com/uae-en/search/?q=meguiars%20car%20air%20freshener&av=0&e[search-ae]=google", "amazon_plp_link": "https://www.amazon.ae/s?k=meguiars+car+air+freshener", "outcome": 4, "performance_tag": "Good", "st_hits": 737, "gmv_oppt": 1109.0}, {"search_term": "godrej car air freshener", "brand_actionable": "Brand Godrej is present on both noon and Amazon with relevant SKUs matching keyword, category, and subcategory.", "assortment_actionable": "Noon offers a comparable variety of Godrej car air freshener variants as Amazon with no significant gaps.", "overall_perception": null, "noon_plp_link": "https://www.noon.com/uae-en/search/?q=godrej%20car%20air%20freshener&av=0&e[search-ae]=google", "amazon_plp_link": "https://www.amazon.ae/s?k=godrej+car+air+freshener", "outcome": 10, "performance_tag": "Below Average", "st_hits": 589, "gmv_oppt": 225.0}, {"search_term": "kovi car air freshener", "brand_actionable": "Brand Kovi is well represented on both noon and Amazon with multiple SKUs, all relevant to car air fresheners in automotive category.", "assortment_actionable": "Noon matches Amazon in Kovi SKU variants and fragrance options; no significant assortment gap within Kovi brand for this keyword.", "overall_perception": null, "noon_plp_link": "https://www.noon.com/uae-en/search/?q=kovi%20car%20air%20freshener&av=0&e[search-ae]=google", "amazon_plp_link": "https://www.amazon.ae/s?k=kovi+car+air+freshener", "outcome": 8, "performance_tag": "Average", "st_hits": 295, "gmv_oppt": 104.0}, {"search_term": "long lasting car air freshener", "brand_actionable": "Brands missing on noon: Godrej, KOVI, SKY-TOUCH, Llum, Involve Your Senses, Bullsone, NICEADA, Schewaz, Areon, Little Trees, Meguiar's, Glade. Common brands: none.", "assortment_actionable": "Noon shows fewer SKUs and brands, dominated by generics and less variety in styles; Amazon has more branded, diverse, and specialized long-lasting car air fresheners.", "overall_perception": null, "noon_plp_link": "https://www.noon.com/uae-en/search/?q=long%20lasting%20car%20air%20freshener&av=0&e[search-ae]=google", "amazon_plp_link": "https://www.amazon.ae/s?k=long+lasting+car+air+freshener", "outcome": 4, "performance_tag": "Good", "st_hits": 589, "gmv_oppt": 324.0}, {"search_term": "car fragrance", "brand_actionable": "Brands missing on noon: KOVI, Involve Your Senses, California Car Scents, SKY-TOUCH, Bullsone, Llum, UrrSovv, Little Trees, Schewaz, Air Wick. Common brands: Godrej, Glade.", "assortment_actionable": "Noon shows fewer SKUs and less brand diversity; dominated by generic and fewer diffuser variants; Amazon offers wider styles and premium options.", "overall_perception": null, "noon_plp_link": "https://www.noon.com/uae-en/search/?q=car%20fragrance&av=0&e[search-ae]=google", "amazon_plp_link": "https://www.amazon.ae/s?k=car+fragrance", "outcome": 5, "performance_tag": "Average", "st_hits": 1179, "gmv_oppt": 571.0}, {"search_term": "car air freshener", "brand_actionable": "Brands missing on noon: Involve Your Senses, Llum, Little Trees, SKY-TOUCH, Home-Cloud, Air Wick, Bullsone, NICEADA, Schewaz, Meguiar'S. Common brands: Godrej, Kovi.", "assortment_actionable": "Noon has fewer brands and SKUs, with dominance of generic products and some irrelevant items; Amazon shows wider brand and product variety in car air fresheners.", "overall_perception": null, "noon_plp_link": "https://www.noon.com/uae-en/search/?q=car%20air%20freshener&av=0&e[search-ae]=google", "amazon_plp_link": "https://www.amazon.ae/s?k=car+air+freshener", "outcome": 1, "performance_tag": "Good", "st_hits": 4420, "gmv_oppt": 2320.0}, {"search_term": "car air freshener spray", "brand_actionable": "Brands missing on noon: AREON, Sonax, Meguiar’s, Chemical Guys, Armor All, Involve, Shatha. Common brands: Godrej, Little Trees, Herios, Naseem.", "assortment_actionable": "Noon shows fewer SKUs and less brand diversity; Amazon offers more premium and varied spray types; some noon items less focused on car air freshener sprays.", "overall_perception": null, "noon_plp_link": "https://www.noon.com/uae-en/search/?q=car%20air%20freshener%20spray&av=0&e[search-ae]=google", "amazon_plp_link": "https://www.amazon.ae/s?k=car+air+freshener+spray", "outcome": 3, "performance_tag": "Good", "st_hits": 589, "gmv_oppt": 401.0}, {"search_term": "natural car air freshener", "brand_actionable": "Brands missing on noon: MANGALAM, Paradise Air, Bullsone, Involve Your Senses, HATTA's, MANOUB, California Scents, AGMC, MOSO NATURAL. Common brands: none.", "assortment_actionable": "Noon shows fewer brands and product variants, dominated by unbranded and SAMEILI; Amazon offers more organic, gel, diffuser, and natural scent options.", "overall_perception": null, "noon_plp_link": "https://www.noon.com/uae-en/search/?q=natural%20car%20air%20freshener&av=0&e[search-ae]=google", "amazon_plp_link": "https://www.amazon.ae/s?k=natural+car+air+freshener", "outcome": 2, "performance_tag": "Average", "st_hits": 884, "gmv_oppt": 752.0}];

    const clean_text = (text) => term.replace(/ /g, '_')

    const linkToDetail = (term) => `<a class="kw-link" href=#${term.replace(/ /g, '_')}>${term}</a>`;

    const toNumber = (v) => {
      if (v === null || v === undefined) return NaN;
      if (typeof v === 'number') return v;
      if (typeof v === 'string') {
        const s = v.replace(/,/g, '').trim();
        return s === '' ? NaN : Number(s);
      }
      return NaN;
    };
    const fmtInt = (v) => Number.isFinite(toNumber(v)) ? toNumber(v).toLocaleString() : "—";
    const fmtNum = (v) =>
      Number.isFinite(toNumber(v))
        ? toNumber(v).toLocaleString(undefined, { minimumFractionDigits:0, maximumFractionDigits:2 })
        : "—";

    const toLink = (url, label) => {
      if (!url || typeof url !== 'string') return '';
      const safe = url.startsWith('http') ? url : null;
      return safe ? `<a href="${safe}" target="_blank" rel="noopener">${label || 'Open'}</a>` : '';
    };
    const escapeHTML = (s) =>
      String(s ?? '').replace(/[&<>"']/g, (m) => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'})[m]);

    // Build single "Actionables" cell (no Show more / no clamping)
    const makeActionablesCell = (row) => {
      const items = [];
      if (row.assortment_actionable) items.push(`<div class="act"><div class="tag">Assortment</div><div class="txt wrap-text">${escapeHTML(row.assortment_actionable)}</div></div>`);
      if (row.brand_actionable) items.push(`<div class="act"><div class="tag">Brand</div><div class="txt wrap-text">${escapeHTML(row.brand_actionable)}</div></div>`);
      const content = items.join('');
      return `<div class="cell-stack"><div class="wrap-text">${content}</div></div>`;
    };

    // Helper: pick GMV opportunity from available keys (gmv_oppt preferred)
    const pickGmvOppt = (row) => {
      const v = row.gmv_oppt ?? row.gmv_loss ?? row.gmv_opportunity ?? null;
      return v;
    };

    document.addEventListener('DOMContentLoaded', () => {
      document.getElementById('pill-score').textContent = fmtInt(EXEC_SUMMARY.overall_score ?? 0);
      document.getElementById('pill-hits').textContent  = fmtInt(EXEC_SUMMARY.overall_st_hits);
      document.getElementById('pill-gmv').textContent   = fmtNum(EXEC_SUMMARY.overall_gmv_oppt);

      // Generic table (center columns)
      $('#tbl-generic').DataTable({
        data: DATA_GENERIC,
        columns: [
          { title:'Search Term',     data:'search_term', className:'text-center align-middle', render:(d)=>linkToDetail(d)},
          { title:'Priority',         data:'outcome',      className:'text-center align-middle', render:(d)=>escapeHTML(d ?? '—') },
          { title:'Est. Hits',     data:'st_hits',     className:'text-center align-middle', render:(d)=>fmtInt(d) },
          { title:'Est. GMV Potential', data:'gmv_oppt',      className:'text-center align-middle', render:(d)=>fmtNum(d) }
        ],
        order: [[1,'asc']], responsive: true, fixedHeader: false, deferRender: true, autoWidth: false,
        pageLength: 10, lengthMenu: [10,25,50,100], dom:'Bfrtip', buttons:['pageLength','copy','csv']
      });

      // Branded table (center columns)
      $('#tbl-branded').DataTable({
        data: DATA_BRANDED,
        columns: [
          { title:'Search Term',     data:'search_term', className:'text-center align-middle', render:(d)=>linkToDetail(d) },
          { title:'Priority',         data:'outcome',      className:'text-center align-middle', render:(d)=>escapeHTML(d ?? '—') },
          { title:'Est. Hits',     data:'st_hits',     className:'text-center align-middle', render:(d)=>fmtInt(d) },
          { title:'Est. GMV Potential', data:'gmv_oppt',      className:'text-center align-middle', render:(d)=>fmtNum(d) }
        ],
        order: [[1,'asc']], responsive: true, fixedHeader: false, deferRender: true, autoWidth: false,
        pageLength: 10, lengthMenu: [10,25,50,100], dom:'Bfrtip', buttons:['pageLength','copy','csv']
      });

      // Detailed Analysis (center everything except Actionables)
      const dtDetail = $('#tbl-detail').DataTable({
        data: DATA_DETAIL,
        columns: [
          { title:'Search Term',     data:'search_term',   width:'10%', className:'text-center align-middle' },
          { title:'Insights',     data:null,            width:'54%', className:'col-actionables', render:(d,t,row)=>makeActionablesCell(row) },
          { title:'Est. Hits',     data:'st_hits',       width:'8%', className:'text-center align-middle', render:(d)=>fmtInt(d) },
          { title:'Est. GMV Potential', data:null,            width:'10%', className:'text-center align-middle', render:(d,t,row)=>fmtNum(pickGmvOppt(row)) },
          { title:'PLP',             data:null,            width:'10%', className:'text-center align-middle',
          render:(d,t,row)=>{const parts = [];
            if (row.noon_plp_link)   parts.push(toLink(row.noon_plp_link,   'noon search results'));
            if (row.amazon_plp_link) parts.push(toLink(row.amazon_plp_link, 'Amazon search results'));
            return parts.length ? '<div class="plp-links">' + parts.join('') + '</div>' : '—';
          }
          }
        ],
        order: [[3,'desc']], responsive: false, fixedHeader: false, deferRender: true, autoWidth: false,
        pageLength: 15, lengthMenu: [15,25,50,100], dom:'Bfrtip', buttons:['pageLength','copy','csv'],
        rowId: (d) => d.search_term.replace(/ /g, '_')
      });

      
    });
  </script>
</body>
</html>
